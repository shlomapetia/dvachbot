# conan.py
import secrets
import random
from datetime import datetime, UTC
import asyncio

# –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ—Ä–∞–∑ –ö–æ–Ω–∞–Ω–∞
SPORT_INVENTS = [
    "—à—Ç–∞–Ω–≥–∞", "–≥–∞–Ω—Ç–µ–ª—è", "–≥–∏—Ä—è", "—ç—Å–ø–∞–Ω–¥–µ—Ä", "–º–µ—à–æ–∫ —Å –ø–µ—Å–∫–æ–º",
    "–º–µ—à–æ–∫ —Å –≥–æ–≤–Ω–æ–º", "–∫–∞–º–µ–Ω—å –∏–∑ –ø–µ–Ω–æ–ø–ª–∞—Å—Ç–∞", "–∫–∞–º–µ–Ω—å –∏–∑ –∫—É—Å–∫–æ–≤ –≥–æ–≤–Ω–∞",
    "—Ç–∞–¥–∂–∏–∫—Å–∫–∏–π —Ö—É–π"
]

INVENT_WEIGHT = [
    "20 –∫–≥", "35 –∫–≥", "50 –∫–≥", "75 –∫–≥", "86 –∫–≥", "72 –∫–≥", "100 –∫–≥", "120 –∫–≥",
    "150 –∫–≥", "200 –∫–≥", "250 –∫–≥", "300 –∫–≥", "350 –∫–≥", "400 –∫–≥", "450 –∫–≥"
]

INSULTS = [
    "–¥–µ–≥–µ–Ω–µ—Ä–∞—Ç", "—à–∏–∑", "—Ö—Ä—è–∫", "—Ä—É—Å–Ω—è", "—Å–ª–∞–±–∞–∫", "–¥—Ä—ã—â", "—á—É—à–ø–∞–Ω", "—Ä—É—Å–Ω—è",
    "—Ç–∞–¥–∂–∏–∫", "–ø–∏–¥–æ—Ä", "–ø–∏–¥–æ—Ä–∞—Å", "—à–∏–∑–æ—Ñ—Ä–µ–Ω–∏–∫", "–∏–¥–∏–æ—Ç", "–¥–µ–±–∏–ª", "–∫—Ä–µ—Ç–∏–Ω",
    "—Ö—É–µ—Å–æ—Å", "—Ö—É–µ–≥–ª–æ—Ç", "—Ö—É–µ–≥—Ä—ã–∑", "—Ö—É–π–ª–∞–Ω", "–∑–∞–ª—É–ø–∞", "–¥—Ä–∏—â", "–¥—Ä–∏—â–∞—Ä–∞", "—á–º–æ", "—Å–∫–æ—Ç"
]

ACHIEVEMENTS = [
    "—Å–ø–µ—Ä–º–æ—Ä–∞–∑—Ä—è–¥–Ω–∏–∫", "–º–∞—Å—Ç–µ—Ä –≥–∏–Ω–æ–≤–∏–∫", "—á–µ–º–ø–∏–æ–Ω –ª–µ—Å–Ω–æ–π –∫–∞—á–∞–ª–∫–∏",
    "–±—Ä–æ–Ω–∑–æ–≤—ã–π –ø—Ä–∏–∑–µ—Ä —Å–ø–∞—Ä—Ç–∞–∫–∏–∞–¥—ã", "–≥—Ä–æ–∑–∞ –≤–æ–∑–±—É–∂–¥–µ–Ω–Ω—ã—Ö –º—É–∂—á–∏–Ω",
    "—Å–ø–µ—Ä–º–æ—Ä–∞–∑—Ä—è–¥–Ω–∏–∫", "–º–∞—Å—Ç–µ—Ä –≥–µ–µ–≤–∏–∫", "—Å–∏—Å—Å–∏", "–º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É",
    "–º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É —à—Ç–∞–Ω–≥–æ–π", "–º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É –≥–∞–Ω—Ç–µ–ª—è–º–∏",
    "–º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É –≥–∏—Ä—è–º–∏", "–≥–ª–∞–≤–Ω—ã–π –ø–∏–¥–æ—Ä –ª–µ—Å–Ω–æ–π –∫–∞—á–∞–ª–∫–∏",
    "–º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É —ç—Å–ø–∞–Ω–¥–µ—Ä–æ–º",
    "–º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É –º–µ—à–∫–æ–º —Å –ø–µ—Å–∫–æ–º",
    "–º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É –º–µ—à–∫–æ–º —Å –≥–æ–≤–Ω–æ–º",
    "–º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É –∫–∞–º–Ω–µ–º –∏–∑ –ø–µ–Ω–æ–ø–ª–∞—Å—Ç–∞",
    "–º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É –∫–∞–º–Ω–µ–º –∏–∑ –∫—É—Å–∫–æ–≤ –≥–æ–≤–Ω–∞",
    "–º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É —à—Ç–∞–Ω–≥–æ–π"
]

SPORT_FACTS = [
    "–ì–∞–±–∞—Ä–∏—Ç—ã –ö–æ–Ω–∞–Ω–∞? ‚Äî –†–æ—Å—Ç 185 –º–º, –≤–µ—Å 94 –≥",
    "–ö–∞–∫–æ–≤—ã —Ç–∏—Ç—É–ª—ã –°–æ—Å–∞–Ω–∞? ‚Äî –î–µ–≤—Å—Ç–≤–µ–Ω–Ω–∏–∫ —Å –±–æ–ª—å—à–æ–π –±—É–∫–≤—ã –î, –∫–∞—á–æ–∫-–≥–µ–µ–≤–∏–∫ —Å—Ç–∞—Ä–æ–π —à–∫–æ–ª—ã, —Å–ø–µ—Ä–º–æ—Ä–∞–∑—Ä—è–¥–Ω–∏–∫ –ø–æ –∂–∏–º—É –ª—ë–∂–∞, —á—ë—Ä–Ω—ã–π –º–∏–Ω–µ—Ç—á–∏–∫",
    "–ù–∞ —á—Ç–æ –∂–∏–≤–µ—Ç –ù–∏–∫–æ–ª–∞–π –†–æ–º–∞–Ω–æ–≤ (–æ–Ω –∂–µ —Å–æ—Å–∞–Ω)? –æ—Ç–≤–µ—Ç: –ù–∏–∫–æ–ª–∞–π —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–ª –ø—Å–∏—Ö–∏—á–µ—Å–∫–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ —Ä–∞–¥–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–µ–Ω—Å–∏–∏",
    "–ü–æ—á–µ–º—É –æ—Ç –°–æ—Å–∞–Ω–∞ –≤–æ–Ω—è–µ—Ç? ‚Äî –°–æ—Å–∞–Ω —Å—Ç–∏—Ä–∞–µ—Ç –≤–µ—â–∏ –ø–æ–¥ –¥–æ–∂–¥—ë–º –∏–ª–∏ –≤ —Ä–µ—á–∫–µ-–≤–æ–Ω—é—á–∫–µ, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ–∑–æ–¥–æ—Ä–∞–Ω—Ç –∏ –¥—É—Ö–∏, –Ω–µ –≤—ã—Ç–∏—Ä–∞–µ—Ç/–ø–æ–¥–º—ã–≤–∞–µ—Ç —Å—Ä–∞–∫—É –ø–æ—Å–ª–µ –∫–∞–ª–æ–∏–∑–≤–µ—Ä–∂–µ–Ω–∏—è",
    "–£–≤—ã, –°–æ—Å–∞–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –±—ã–ª –∏–∑–≥–Ω–∞–Ω –∏–∑ –ª–µ—Å–Ω–æ–π –∫–∞—á–∞–ª–∫–∏ –∑–∞ –≥–Ω–∏–ª–æ–π –±–∞–∑–∞—Ä –∏ –Ω–µ–º—ã—Ç—É—é —Å—Ä–∞–∫—É.",
    "–°–æ—Å–∞–Ω –Ω–µ–Ω–∞–≤–∏–¥–∏—Ç —Å–∫–æ—Ç–æ–≤, –∂–∏–≤—É—â–∏—Ö –≤ —Å–∫–æ—Ç–æ–±–ª–æ–∫–∞—Ö –∏ –∂—Ä—É—â–∏—Ö —Ä—É—Å—Å–∫–æ–µ —Ö—Ä—é—á–µ–≤–æ, –æ—Å—É–∂–¥–∞–µ—Ç –≤–∫—É—Å–Ω–æ –∏ —Ç–æ—á–∫–∞ –∏ –¥—Ä—É–≥–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è. –ë—ã–ª –æ—Ç—à–∏—Ç –≤—Å–µ–º–∏ –¥–µ–≤—É—à–∫–∞–º–∏ –∏–∑-–∑–∞ —É–º—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ç—Å—Ç–∞–ª–æ—Å—Ç–∏ –∏ –æ–º–µ–∂–Ω–æ—Å—Ç–∏, –Ω–æ –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–µ –±—Ä–æ—Å–∞–µ—Ç –ø–æ–ø—ã—Ç–æ–∫ –Ω–∞–π—Ç–∏ –≤—Ç–æ—Ä—É—é –ø–æ–ª–æ–≤–∏–Ω–∫—É. –ù—é—Ö–∞–ª —Ç—Ä—É—Å—ã —Å–≤–æ–µ–π —Å–µ—Å—Ç—Ä—ã –∏ –±—Ä–∞—Ç–∞ —Ñ–µ–π—Å–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞—Ä–º—É —Ä–∞–¥–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã—Ö —Å–≤–µ—Ä—à–µ–Ω–∏–π",
    "–ö–∞–∫–æ–≤ —Ä–∞–∑–º–µ—Ä –ø–µ–Ω—Å–∏–∏ –ß–º–æ–Ω–∞–Ω–∞? –æ—Ç–≤–µ—Ç: –î–æ–ø–æ–¥–ª–∏–Ω–Ω–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ, –ø—Ä–∏–º–µ—Ä–Ω–æ 22-23–∫",
    "–ì–¥–µ –∂–∏–≤–µ—Ç –ù–∏–∫–æ–ª–∞–π –ö–æ–Ω–∞–Ω? –û—Ç–≤–µ—Ç: –í –¢–∏–º–∏—Ä—è–∑–µ–≤—Å–∫–æ–º —Ä–∞–π–æ–Ω–µ –Ω–∞ —Å–µ–≤–µ—Ä–µ –ú–æ—Å–∫–≤—ã",
    "–°–∫–æ–ª—å–∫–æ –ö–æ–Ω–∞–Ω—É –ª–µ—Ç? –û—Ç–≤–µ—Ç: –ù–∏–∫–æ–ª–∞–π —Ä–æ–¥–∏–ª—Å—è 09.12.1999, –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –µ–º—É 25 –ª–µ—Ç.   –í –∫–∞–∫–∏–µ –∏–≥—Ä—ã –∏–≥—Ä–∞–µ—Ç/–∏–≥—Ä–∞–ª –ù–∏–∫–æ–ª–∞–π? –û—Ç–≤–µ—Ç: –ö—Å 1.6, –ö—Å —Å–æ—É—Ä—Å, WoW, –ú–∞–π–Ω–∫—Ä–∞—Ñ—Ç, –õ–∞—Ä–∞, –ö—Ä–æ—Ñ—Ç, –†—É–Ω–∞",
    "–ù–∏–∫–æ–ª–∞–π –°–æ—Å–∞–Ω (–æ–Ω –∂–µ —á–º–æ–Ω–∞–Ω, –æ–Ω –∂–µ –∫–æ–∫–æ–Ω, –æ–Ω –∂–µ –ø–µ–Ω–æ–ø–ª–∞—Å—Ç, –æ–Ω –∂–µ –ø–µ–ª–∏–∫–∞–Ω, –æ–Ω –∂–µ –≥—É–∏–º–ø–ª–µ–Ω) –†–æ–º–∞–Ω–æ–≤ - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —à–∏–∑–æ—Ñ—Ä–µ–Ω–∏–∫ —Å –º–∞–Ω–∏–µ–π –≤–µ–ª–∏—á–∏—è –∏ –º–∏–∫—Ä–æ–ø–µ–Ω–∏—Å–æ–º. –ñ–∏–º—Ü–µ–ª—å—Å–∫–∞—è –Ω–æ—à–∞ —Å–∏–ª—å–Ω–æ –¥–∞–≤–∏—Ç –Ω–∞ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ –ö–æ–ª–∏ –∏ –æ–Ω —Å—Ä–µ—Ç –≤ —Ç—Ä–µ–¥–∞—Ö —Å–≤–æ–∏–º–∏ –≥–æ–º–æ–ø–∞—Å—Ç–∞–º–∏. –ò–∑ —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ö–ú–° –ø–æ –±–µ–≥—É –æ—Ç –º–µ–Ω—Ç–æ–≤. –ú–° –ø–æ —à–∏–∑–µ (–∑–∞—Å–ª—É–∂–µ–Ω–Ω—ã–π). –ß–°–í –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞.",
    "–í 17 –ª–µ—Ç –°–æ—Å–∞–Ω –Ω–∞–≥—Ä–µ–ª –Ω–∞ –∫–æ—Å—Ç—Ä–µ –∏ –ø—Ä–æ–∂–µ–≥ —Å–µ–±–µ –Ω–∞ –≥—Ä—É–¥–∏ –¥—ã—Ä–∫–∏, —à—Ä–∞–º—ã —è–∫–æ–±—ã –æ—Ç —Ñ–µ—Ö—Ç–æ–≤–∞–Ω–∏—è, —É—à–µ–ª –≤ –¥—É—Ä–∫—É –∏ –ø–æ–ª—É—á–∏–ª –±–µ–ª—ã–π –±–∏–ª–µ—Ç.",
    "–°–æ—Å–∞–Ω, –≤–µ—Ä–æ—è—Ç–Ω–æ –Ω–µ —Å–∏–¥–∏—Ç –∏—Ç—Ç, –∑–∞—Ç–æ –∏–º –ø—Ä–∏—Ç–≤–æ—Ä—è–µ—Ç—Å—è –∂–∏—Ä–Ω–æ–∂–æ–ø—ã–π –≤—ã—Ä–æ–∂–¥–µ–Ω–µ—Ü, –ø—Ä–∏–∫—Ä—É—á–µ–Ω–Ω—ã–π –∫ –∏–Ω–≤–∞–ª–∏–¥–Ω–æ–º—É —Å—Ç—É–ª—É, —á—Ç–æ–±—ã —Ç—Ä–æ–ª–ª–∏—Ç—å –∏ –≥—Ä—É–±–∏—Ç—å –∞–Ω–æ–Ω–∞–º"
]

CATCHPHRASES = [
    "–¢—É—Ö–ª—ã–π —Ñ–æ—Ä—Å –æ—Ç —Ä—É—Å–Ω–∏", "–ü—Ä–µ–∫–ª–æ–Ω–∏—Ç–µ—Å—å –ø–µ—Ä–µ–¥ –ò–º–ø–µ—Ä–∞—Ç–æ—Ä–æ–º", "–Ø —Å–æ—Å–∞–ª!",
    "–ß–µ—Ä–Ω—å, –ø—Ä–∏–∫–∞–∑—ã–≤–∞—é —Ç–µ–±–µ!", "–≠–∫—Ç–æ–º–æ—Ä—Ñ –ø–æ–∂–∞–ª —à—Ç–∞–Ω–≥—É 86 –∫–∏–ª–æ–≥—Ä–∞–º–º", "–î–∞–π –º–Ω–µ –≤ –∂–æ–ø—É", "–¢—ã –ø–æ–∂–∞–ª–µ–µ—à—å –æ —Å–≤–æ–∏—Ö —Å–ª–æ–≤–∞—Ö, —Å–∫–æ—Ç"
]

TEMPLATES = [
    "–¢—ã —É–Ω–∏–∂–µ–Ω, {name}, —Ç—ã –¥—Ä—ã—â –Ω–µ –æ—Å–∏–ª–∏—à—å {inv} {wgt}",
    "–ù–∞ –∫–æ–ª–µ–Ω–∏, —Ä–∞–±, {name}", "–í –≥–ª–∞–∑–∞ –¥–æ–ª–±–∏—à—å—Å—è, {ins}? –Ø {ach}.",
    "–í –≥–ª–∞–∑–∞ –¥–æ–ª–±–∏—à—å—Å—è, {ins}? –†—É—Å–Ω—è —Ç—ã –∑–Ω–∞–µ—à—å —á—Ç–æ —è {ach}?",
    "–ú–æ–ª—á–∏ –º—Ä–∞–∑—å. –Ø {ach}", "–ú–æ–ª—á–∏ —Ä—É—Å–Ω—è. –Ø {ach}",
    "–¢—ã –∑–Ω–∞–µ—à—å —á—Ç–æ —Å —Ç–æ–±–æ–π –æ–±—â–∞–µ—Ç—Å—è {ach}?", "–¢—ã –∑–Ω–∞–µ—à—å —á—Ç–æ —è {ach}?",
    "–¢—ã –∑–Ω–∞–µ—à—å —á—Ç–æ —è —Å–æ—Å–∞–ª?", "{ins} –¥—Ä–∏—â–∞–≤—ã–π {ins}", "–¢—ã –≤—ã–≥–ª—è–¥–∏—à—å –∫–∞–∫ {ins}",
    "–£ —Ç–µ–±—è —à–∏–∑–∞, {ins}", "–£ —Ç–µ–±—è —à–∏–∑–∞",
    "–°–ª–∞–±–∞—è —Ä—É—Å–Ω—è –Ω–µ –ø–æ–¥–Ω–∏–º–∞–µ—Ç {inv} {wgt}", "–¢—ã –Ω–µ –æ—Å–∏–ª–∏—à—å {inv} {wgt}",
    "–î–∞, —è —Å–æ—Å–∞–ª.", "–ë—É–¥—É –ª–∏ —è —Ö—É–π?",
    "–°–ø–æ–∫—É—Ö–∞, {ins}", "–¢–∞–±–ª–µ—Ç–∫–∏ –ø—Ä–∏–º–∏, {ins}", "{fact}",
    "–†—É—Å–Ω—è, –∞ —Ç—ã –∑–Ω–∞–µ—à—å —ç—Ç–æ—Ç —Ñ–∞–∫—Ç –ø—Ä–æ –º–µ–Ω—è? {fact}",
    "–ü—Ä–∞–≤–¥–∞ –≥–ª–∞–∑–∞ —Ä–µ–∂–µ—Ç, {ins}?", "{catch}", "{ins} —Ç—ã —Å —É–º–∞ —Å–æ—à–µ–ª –æ—Ç –∑–∞–≤–∏—Å—Ç–∏",
    "–ü—Ä–æ–µ–∫—Ü–∏–∏, {ins}", "–ó–∞–ø–æ–º–Ω–∏. {fact}", "–°–µ–π—á–∞—Å –æ–±–æ—Å—Å—É, {ins}",
    "–í –ø–∞–ª–∞—Ç—É –≤–µ—Ä–Ω–∏—Å—å, {ins}", "–ú–∞–Ω—è–º–∏—Ä–æ–∫ –≤—ã–∫–ª—é—á–∏, {ins}",
    "{ins} —á–º–æ —Ç—ã —Å —É–º–∞ —Å–æ—à–ª–æ –æ—Ç –∑–∞–≤–∏—Å—Ç–∏", "–¢—ã {ins}",
    "–ö–∞–∂–µ—Ç—Å—è –ø–æ—Ä–∞ –ø—Ä–æ—É—á–∏—Ç—å —Ç–µ–±—è –ø–∏–¥–æ—Ä–∞—Å. –ë–æ–ª—å—à–æ–π –∞—Ñ–≥–∞–Ω—Å–∫–∏–π –¥—è–¥—è –Ω–∞–∫–∞–∂–µ—Ç —Ç–µ–±—è.", "–¢—ã –ø–æ—Ö–æ–∂ –Ω–∞ {ins}",
    "–¢—ã –≤—ã–≥–ª—è–¥–∏—à—å –∫–∞–∫ —Ä—É—Å–Ω—è–≤—ã–π {ins}", "–ö–∞–∫–æ–π –∂–µ —Ç—ã {ins}!",
    "–ü—Ä–∏–≤–µ—Ç, –ø—Ä–∏—è—Ç–µ–ª—å!", "–ü—Ä–∏—Ö–æ–¥–∏ –≤ –ª–µ—Å–Ω—É—é –∫–∞—á–∞–ª–∫—É, {ins}", "–ü—Ä–∏–≤–µ—Ç, –ø—Ä–∏—è—Ç–µ–ª—å!", "–ü—Ä–∏–≤–µ—Ç, –ø—Ä–∏—è—Ç–µ–ª—å!", 
    "–¢—ã —É–Ω–∏–∂–µ–Ω —à—Ç–∞–Ω–≥–æ–π –≤ {wgt}", "–Ø –º–∞—Å—Ç–µ—Ä —Å–ø–æ—Ä—Ç–∞ –ø–æ –∂–∏–º—É {inv} {wgt}",
    "–¢–´ –±—É–¥–µ—à—å –∂–∏—Ç—å –≤ —Å—Ç—Ä–∞—Ö–µ, {ins}", "–Ø —É–Ω–∏—á—Ç–æ–∂—É —Ç–µ–±—è, {ins}",
    "–ù–∞ –∫–æ–ª–µ–Ω–∏, {ins}", "–°–¥–æ—Ö–Ω–∏, {ins}", "–Ø –∂–º—É {wgt} –æ—Ç –≥—Ä—É–¥–∏",
    "–Ø –∂–º—É {wgt} –∞–Ω—É—Å–æ–º", "–Ø –∂–º—É {wgt} —Å–≤–æ–∏–º —Ä—Ç–æ–º", "–Ø –∂–º—É {wgt}",
    "–Ø –ø–æ–¥–Ω–∏–º–∞–ª –∫–∞–º–µ–Ω—å –≤ {wgt}", "–Ø —Å–æ—Å–∞–ª", "–î–∞, —è —Å–æ—Å–∞–ª. –Ø —Å–æ—Å–∞–ª —Ç—ã—Å—è—á–µ–ª–µ—Ç–∏—è–º–∏."
    "–Ø —Å–æ–≤–∞–ª –∫–∞–º–µ–Ω—å –≤ {wgt} —Å–µ–±–µ –≤ —Å–≤–æ—é –¥—ã—Ä—è–≤—É—é, –æ–±–æ—Å—Ä–∞–Ω–Ω—É—é, –≤–æ–Ω—é—á—É—é —Å—Ä–∞–∫—É.",
    "–Ø –¥–µ–ª–∞—é –∂–∏–º –Ω–∞ —è–π—Ü–µ–ø—Å –∫–∞–∂–¥–æ–µ —É—Ç—Ä–æ", "–¢–≤–æ–∏ –ø—Ä–æ–µ–∫—Ü–∏–∏, {ins} –µ–±–∞–Ω—ã–π.",
    "–°–æ–π–¥—ë—Ç –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–æ–ª—å–∫–æ –≤ —Ç–≤–æ—ë–º –º–∞–Ω—è–º–∏—Ä–∫–µ", "–ü—Ä–∏–≤–µ—Ç, –ø—Ä–∏—è—Ç–µ–ª—å! –ü–æ—Ä–∞–∑–º–∏–Ω–∞–µ–º—Å—è –≤ –ª–µ—Å—É?", 
    "–ù–µ–Ω–∞–≤–∏–∂—É —Ç–∞–∫–∏—Ö —Å–ª–∞–±–∞–∫–æ–≤ –∫–∞–∫ —Ç—ã, {ins}. –í—ã –Ω–µ —Å–ø–æ—Å–æ–±–Ω—ã –æ—Å–∏–ª–∏—Ç—å –Ω–∏ –æ–¥–Ω–æ–≥–æ –º—É–∂—Å–∫–æ–≥–æ —á–ª–µ–Ω–∞!", "–ù–µ –≤—ã–≤–µ–∑ –≤–µ—Å–∞? {ins} –µ–±–∞–Ω—ã–π",
    "–í –ø–∞–ª–∞—Ç—É –≤–µ—Ä–Ω–∏—Å—å, –µ–±–∞–Ω—ã–π {ins}", "–Ø –∫–æ—Ä–æ–ª—å –º—É–∂—Å–∫–∏—Ö —á–ª–µ–Ω–æ–≤"
]


def conan_phrase(username: str = "–ü—Ä–∏—è—Ç–µ–ª—å") -> str:
    tpl = secrets.choice(TEMPLATES)
    return tpl.format(
        name=username,
        inv=secrets.choice(SPORT_INVENTS),
        wgt=secrets.choice(INVENT_WEIGHT),
        ach=secrets.choice(ACHIEVEMENTS),
        ins=secrets.choice(INSULTS),
        fact=secrets.choice(SPORT_FACTS),
        catch=secrets.choice(CATCHPHRASES),
    )

async def conan_roaster(
    format_header_func,   # –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
    boards_data,          # –°–ª–æ–≤–∞—Ä—å —Å–æ –≤—Å–µ–º–∏ –¥–æ—Å–∫–∞–º–∏
    global_messages_storage, # –ï–¥–∏–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø–æ—Å—Ç–æ–≤
    board_message_to_post_dict, # –°–ª–æ–≤–∞—Ä—å —Å–æ —Å–ª–æ–≤–∞—Ä—è–º–∏ message_to_post
    board_post_to_messages_dict, # –°–ª–æ–≤–∞—Ä—å —Å–æ —Å–ª–æ–≤–∞—Ä—è–º–∏ post_to_messages
    queues,               # –°–ª–æ–≤–∞—Ä—å —Å –æ—á–µ—Ä–µ–¥—è–º–∏
    ):
    """–ö–∞–∂–¥—ã–µ 5-18 –º–∏–Ω—É—Ç –ö–æ–Ω–∞–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Å—Ç –Ω–∞ —Å–ª—É—á–∞–π–Ω–æ–π –¥–æ—Å–∫–µ."""
    while True:
        try:
            await asyncio.sleep(random.randint(300, 1080)) # 5-18 –º–∏–Ω—É—Ç

            # –ù–∞—Ö–æ–¥–∏–º –¥–æ—Å–∫–∏, –≥–¥–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –ø–æ—Å—Ç—ã
            eligible_boards = [
                b_id for b_id, data in boards_data.items()
                if data['users_data']['active'] and board_message_to_post_dict.get(b_id)
            ]
            if not eligible_boards:
                continue

            target_board_id = random.choice(eligible_boards)
            
            board_message_to_post = board_message_to_post_dict[target_board_id]
            if not board_message_to_post:
                continue

            random_reply_key = random.choice(list(board_message_to_post.keys()))
            target_post_num = board_message_to_post.get(random_reply_key)
            
            if not target_post_num or target_post_num not in global_messages_storage:
                continue

            phrase = conan_phrase()
            header, new_pnum = format_header_func(target_board_id)
            
            global_messages_storage[new_pnum] = {
                'board_id': target_board_id,
                'author_id': 0,
                'timestamp': datetime.now(UTC),
                'content': {'type': 'text', 'header': header, 'text': phrase},
                'reply_to': target_post_num
            }

            await queues[target_board_id].put({
                "recipients": boards_data[target_board_id]['users_data']['active'],
                "content": {
                    "type": "text",
                    "header": header,
                    "text": phrase,
                    "reply_to_post": target_post_num
                },
                "post_num": new_pnum,
                "reply_info": board_post_to_messages_dict[target_board_id].get(target_post_num, {})
            })

            print(f"üí™ –ö–æ–Ω–∞–Ω –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ –ø–æ—Å—Ç #{target_post_num} –Ω–∞ –¥–æ—Å–∫–µ /{target_board_id}/")

        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –≤ Conan_roaster: {e}")
            await asyncio.sleep(60)
